(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-4f14e4ea"],{1199:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("fa73");class s{constructor(e){this.commandFinished=Promise.resolve(),this._renderer=e}setGeometry(e,t){this._renderer.geometry.bind(e,t.glProgram)}finishRenderPass(){}draw(e){const t=this._renderer,{geometry:r,shader:n,state:s,skipSync:a,topology:i,size:o,start:c,instanceCount:u}=e;t.shader.bind(n,a),t.geometry.bind(r,t.shader._activeProgram),s&&t.state.set(s),t.geometry.draw(i,o,c,null!==u&&void 0!==u?u:r.instanceCount)}destroy(){this._renderer=null}}s.extension={type:[n["a"].WebGLSystem],name:"encoder"}},"151e":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("d6d9");const s={id:"video",upload(e,t,r,s){e.isValid?n["a"].upload(e,t,r,s):r.texImage2D(t.target,0,t.internalFormat,1,1,0,t.format,t.type,null)}}},"1c5b":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fa73"),s=r("eb07"),a=r("3d21");class i extends s["a"]{constructor(e){super(e),this.adaptor=new a["a"],this.adaptor.init(e,this)}}i.extension={type:[n["a"].WebGLSystem],name:"renderTarget"}},"1f03":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r("907a"),r("986a"),r("1d02"),r("3c5d"),r("1b3b"),r("3d71"),r("c6e3");function n(e){const t=new Array(e);for(let r=0;r<t.length;r++)t[r]=!1;return t}function s(e,t){switch(e){case"float":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"int":case"uint":case"sampler2D":case"sampler2DArray":return 0;case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"uvec2":return new Uint32Array(2*t);case"uvec3":return new Uint32Array(3*t);case"uvec4":return new Uint32Array(4*t);case"bool":return!1;case"bvec2":return n(2*t);case"bvec3":return n(3*t);case"bvec4":return n(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}},2095:function(e,t,r){"use strict";r.r(t),r.d(t,"WebGLRenderer",(function(){return I}));var n=r("fa73"),s=r("8fa4"),a=r("8fa2"),i=r("4b87"),o=r("3969"),c=r("4925"),u=r("fd09"),l=r("85c4"),_=r("fb0c"),f=r("4c7f"),d=r("8753"),h=r("a582"),g=r("1199"),m=r("cdc1"),E=r("3485"),b=r("1c5b"),T=r("7c8a"),R=r("aae5"),v=r("e1eb"),S=r("381d");const p=[...c["b"],E["a"],d["a"],_["a"],l["a"],S["a"],b["a"],f["a"],R["a"],T["a"],g["a"],v["a"],m["a"],h["a"]],x=[...c["a"]],A=[i["a"],a["a"],s["a"]],B=[],N=[],G=[];n["b"].handleByNamedList(n["a"].WebGLSystem,B),n["b"].handleByNamedList(n["a"].WebGLPipes,N),n["b"].handleByNamedList(n["a"].WebGLPipesAdaptor,G),n["b"].add(...p,...x,...A);class I extends o["a"]{constructor(){const e={name:"webgl",type:u["a"].WEBGL,systems:B,renderPipes:N,renderPipeAdaptors:G};super(e)}}},"20dd":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("14d9");var n=r("991a"),s=r("3456"),a=r("30b1"),i=r("2722");function o(e,t){const r=["\n        var v = null;\n        var cv = null;\n        var cu = null;\n        var t = 0;\n        var gl = renderer.gl;\n        var name = null;\n    "];for(const o in e.uniforms){if(!t[o]){e.uniforms[o]instanceof s["a"]?e.uniforms[o].ubo?r.push(`\n                        renderer.shader.bindUniformBlock(uv.${o}, "${o}");\n                    `):r.push(`\n                        renderer.shader.updateUniformGroup(uv.${o});\n                    `):e.uniforms[o]instanceof n["a"]&&r.push(`\n                        renderer.shader.bindBufferResource(uv.${o}, "${o}");\n                    `);continue}const c=e.uniformStructures[o];let u=!1;for(let e=0;e<a["a"].length;e++){const t=a["a"][e];if(c.type===t.type&&t.test(c)){r.push(`name = "${o}";`,a["a"][e].uniform),u=!0;break}}if(!u){const e=1===c.size?i["b"]:i["a"],t=e[c.type].replace("location",`ud["${o}"].location`);r.push(`\n            cu = ud["${o}"];\n            cv = cu.value;\n            v = uv["${o}"];\n            ${t};`)}}return new Function("ud","uv","renderer","syncData",r.join("\n"))}},2722:function(e,t,r){"use strict";r.d(t,"a",(function(){return s})),r.d(t,"b",(function(){return n}));const n={f32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1f(location, v);\n        }","vec2<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2f(location, v[0], v[1]);\n        }","vec3<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3f(location, v[0], v[1], v[2]);\n        }","vec4<f32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4f(location, v[0], v[1], v[2], v[3]);\n        }",i32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }","vec2<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }","vec3<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }","vec4<i32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }",u32:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1ui(location, v);\n        }","vec2<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2ui(location, v[0], v[1]);\n        }","vec3<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3ui(location, v[0], v[1], v[2]);\n        }","vec4<u32>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4ui(location, v[0], v[1], v[2], v[3]);\n        }",bool:"if (cv !== v) {\n            cu.value = v;\n            gl.uniform1i(location, v);\n        }","vec2<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            gl.uniform2i(location, v[0], v[1]);\n        }","vec3<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            gl.uniform3i(location, v[0], v[1], v[2]);\n        }","vec4<bool>":"if (cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3]) {\n            cv[0] = v[0];\n            cv[1] = v[1];\n            cv[2] = v[2];\n            cv[3] = v[3];\n            gl.uniform4i(location, v[0], v[1], v[2], v[3]);\n        }","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);"},s={f32:"gl.uniform1fv(location, v);","vec2<f32>":"gl.uniform2fv(location, v);","vec3<f32>":"gl.uniform3fv(location, v);","vec4<f32>":"gl.uniform4fv(location, v);","mat2x2<f32>":"gl.uniformMatrix2fv(location, false, v);","mat3x3<f32>":"gl.uniformMatrix3fv(location, false, v);","mat4x4<f32>":"gl.uniformMatrix4fv(location, false, v);",i32:"gl.uniform1iv(location, v);","vec2<i32>":"gl.uniform2iv(location, v);","vec3<i32>":"gl.uniform3iv(location, v);","vec4<i32>":"gl.uniform4iv(location, v);",u32:"gl.uniform1iv(location, v);","vec2<u32>":"gl.uniform2iv(location, v);","vec3<u32>":"gl.uniform3iv(location, v);","vec4<u32>":"gl.uniform4iv(location, v);",bool:"gl.uniform1iv(location, v);","vec2<bool>":"gl.uniform2iv(location, v);","vec3<bool>":"gl.uniform3iv(location, v);","vec4<bool>":"gl.uniform4iv(location, v);"}},2911:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("14d9");var n=r("991a"),s=r("3456"),a=r("8591");function i(e,t){const r=[],i=["\n        var g = s.groups;\n        var sS = r.shader;\n        var p = s.glProgram;\n        var ugS = r.uniformGroup;\n        var resources;\n    "];let o=!1,c=0,u=0;const l=t._getProgramData(e.glProgram);for(const f in e.groups){const _=e.groups[f];r.push(`\n            resources = g[${f}].resources;\n        `);for(const d in _.resources){const h=_.resources[d];if(h instanceof s["a"])h.ubo?r.push(`\n                        sS.bindUniformBlock(\n                            resources[${d}],\n                            sS._uniformBindMap[${f}[${d}],\n                            ${c++}\n                        );\n                    `):r.push(`\n                        ugS.updateUniformGroup(resources[${d}], p, sD);\n                    `);else if(h instanceof n["a"])r.push(`\n                    sS.bindUniformBlock(\n                        resources[${d}],\n                        sS._uniformBindMap[${f}[${d}],\n                        ${c++}\n                    );\n                `);else if(h instanceof a["a"]){const n=e._uniformBindMap[f][d],s=l.uniformData[n];s&&(o||(o=!0,i.push("\n                        var tS = r.texture;\n                        ")),t._gl.uniform1i(s.location,u),r.push(`\n                        tS.bind(resources[${d}], ${u});\n                    `),u++)}}}const _=[...i,...r].join("\n");return new Function("r","s","sD",_)}},3440:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s}));r("d9e2");const n={f32:4,"vec2<f32>":8,"vec3<f32>":12,"vec4<f32>":16,"mat2x2<f32>":32,"mat3x3<f32>":48,"mat4x4<f32>":64};function s(e){const t=e.map(e=>({data:e,offset:0,size:0}));let r=0,s=0,a=0;for(let i=0;i<t.length;i++){const e=t[i];if(r=n[e.data.type],!r)throw new Error("Unknown type "+e.data.type);if(e.data.size>1&&(r=Math.max(r,16)*e.data.size),e.size=r,s%r!==0&&s<16){const e=s%r%16;s+=e,a+=e}s+r>16?(a=16*Math.ceil(a/16),e.offset=a,a+=r,s=r):(e.offset=a,s+=r,a+=r)}return a=16*Math.ceil(a/16),{uboElements:t,size:a}}},3485:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fa73"),s=r("fe508"),a=r("3440"),i=r("3cea");class o extends s["a"]{constructor(){super({createUboElements:a["b"],generateUboSync:i["a"]})}}o.extension={type:[n["a"].WebGLSystem],name:"ubo"}},"381d":function(e,t,r){"use strict";r.d(t,"a",(function(){return m}));r("14d9"),r("907a"),r("986a"),r("1d02"),r("3c5d"),r("1b3b"),r("3d71"),r("c6e3");var n=r("536a"),s=r("fa73"),a=r("af3f"),i=r("d355"),o=r("b716"),c=r("86de"),u=r("d6d9"),l=r("151e"),_=r("ce4b"),f=r("5519"),d=r("eb0b"),h=r("567e");const g=4;class m{constructor(e){this.managedTextures=[],this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundTextures=[],this._activeTextureLocation=-1,this._boundSamplers=Object.create(null),this._uploads={image:u["a"],buffer:o["a"],video:l["a"],compressed:c["a"]},this._useSeparateSamplers=!1,this._renderer=e}contextChange(e){this._gl=e,this._mapFormatToInternalFormat||(this._mapFormatToInternalFormat=Object(d["a"])(e,this._renderer.context.extensions),this._mapFormatToType=Object(h["a"])(e),this._mapFormatToFormat=Object(f["a"])(e)),this._glTextures=Object.create(null),this._glSamplers=Object.create(null),this._boundSamplers=Object.create(null);for(let t=0;t<16;t++)this.bind(a["a"].EMPTY,t)}initSource(e){this.bind(e)}bind(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=e.source;e?(this.bindSource(r,t),this._useSeparateSamplers&&this._bindSampler(r.style,t)):(this.bindSource(null,t),this._useSeparateSamplers&&this._bindSampler(null,t))}bindSource(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=this._gl;if(e._touched=this._renderer.textureGC.count,this._boundTextures[t]!==e){this._boundTextures[t]=e,this._activateLocation(t),e=e||a["a"].EMPTY.source;const n=this.getGlSource(e);r.bindTexture(n.target,n.texture)}}_bindSampler(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;const r=this._gl;if(!e)return this._boundSamplers[t]=null,void r.bindSampler(t,null);const n=this._getGlSampler(e);this._boundSamplers[t]!==n&&(this._boundSamplers[t]=n,r.bindSampler(t,n))}unbind(e){const t=e.source,r=this._boundTextures,n=this._gl;for(let s=0;s<r.length;s++)if(r[s]===t){this._activateLocation(s);const e=this.getGlSource(t);n.bindTexture(e.target,null),r[s]=null}}_activateLocation(e){this._activeTextureLocation!==e&&(this._activeTextureLocation=e,this._gl.activeTexture(this._gl.TEXTURE0+e))}_initSource(e){const t=this._gl,r=new i["a"](t.createTexture());if(r.type=this._mapFormatToType[e.format],r.internalFormat=this._mapFormatToInternalFormat[e.format],r.format=this._mapFormatToFormat[e.format],e.autoGenerateMipmaps&&(this._renderer.context.supports.nonPowOf2mipmaps||e.isPowerOfTwo)){const t=Math.max(e.width,e.height);e.mipLevelCount=Math.floor(Math.log2(t))+1}return this._glTextures[e.uid]=r,this.managedTextures.includes(e)||(e.on("update",this.onSourceUpdate,this),e.on("resize",this.onSourceUpdate,this),e.on("styleChange",this.onStyleChange,this),e.on("destroy",this.onSourceDestroy,this),e.on("unload",this.onSourceUnload,this),e.on("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.push(e)),this.onSourceUpdate(e),this.updateStyle(e,!1),r}onStyleChange(e){this.updateStyle(e,!1)}updateStyle(e,t){const r=this._gl,n=this.getGlSource(e);r.bindTexture(r.TEXTURE_2D,n.texture),this._boundTextures[this._activeTextureLocation]=e,Object(_["a"])(e.style,r,e.mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"texParameteri",r.TEXTURE_2D,!this._renderer.context.supports.nonPowOf2wrapping&&!e.isPowerOfTwo,t)}onSourceUnload(e){const t=this._glTextures[e.uid];t&&(this.unbind(e),this._glTextures[e.uid]=null,this._gl.deleteTexture(t.texture))}onSourceUpdate(e){const t=this._gl,r=this.getGlSource(e);t.bindTexture(t.TEXTURE_2D,r.texture),this._boundTextures[this._activeTextureLocation]=e,this._uploads[e.uploadMethodId]?this._uploads[e.uploadMethodId].upload(e,r,t,this._renderer.context.webGLVersion):t.texImage2D(t.TEXTURE_2D,0,t.RGBA,e.pixelWidth,e.pixelHeight,0,t.RGBA,t.UNSIGNED_BYTE,null),e.autoGenerateMipmaps&&e.mipLevelCount>1&&this.onUpdateMipmaps(e,!1)}onUpdateMipmaps(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1];t&&this.bindSource(e,0);const r=this.getGlSource(e);this._gl.generateMipmap(r.target)}onSourceDestroy(e){e.off("destroy",this.onSourceDestroy,this),e.off("update",this.onSourceUpdate,this),e.off("resize",this.onSourceUpdate,this),e.off("unload",this.onSourceUnload,this),e.off("styleChange",this.onStyleChange,this),e.off("updateMipmaps",this.onUpdateMipmaps,this),this.managedTextures.splice(this.managedTextures.indexOf(e),1),this.onSourceUnload(e)}_initSampler(e){const t=this._gl,r=this._gl.createSampler();return this._glSamplers[e._resourceId]=r,Object(_["a"])(e,t,this._boundTextures[this._activeTextureLocation].mipLevelCount>1,this._renderer.context.extensions.anisotropicFiltering,"samplerParameteri",r,!1,!0),this._glSamplers[e._resourceId]}_getGlSampler(e){return this._glSamplers[e._resourceId]||this._initSampler(e)}getGlSource(e){return this._glTextures[e.uid]||this._initSource(e)}generateCanvas(e){const{pixels:t,width:r,height:s}=this.getPixels(e),a=n["a"].get().createCanvas();a.width=r,a.height=s;const i=a.getContext("2d");if(i){const e=i.createImageData(r,s);e.data.set(t),i.putImageData(e,0,0)}return a}getPixels(e){const t=e.source.resolution,r=e.frame,n=Math.max(Math.round(r.width*t),1),s=Math.max(Math.round(r.height*t),1),a=new Uint8Array(g*n*s),i=this._renderer,o=i.renderTarget.getRenderTarget(e),c=i.renderTarget.getGpuRenderTarget(o),u=i.gl;return u.bindFramebuffer(u.FRAMEBUFFER,c.resolveTargetFramebuffer),u.readPixels(Math.round(r.x*t),Math.round(r.y*t),n,s,u.RGBA,u.UNSIGNED_BYTE,a),{pixels:new Uint8ClampedArray(a.buffer),width:n,height:s}}destroy(){this.managedTextures.slice().forEach(e=>this.onSourceDestroy(e)),this.managedTextures=null,this._renderer=null}}m.extension={type:[s["a"].WebGLSystem],name:"texture"}},"3cea":function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("91be"),s=r("f08f"),a=r("4d70");function i(e){return Object(n["a"])(e,"uboStd40",a["a"],s["a"])}},"3d21":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("deec"),s=r("2a40"),a=r("55b0"),i=r("92be");class o{constructor(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new n["a"]}init(e,t){this._renderer=e,this._renderTargetSystem=t,e.runners.contextChange.add(this)}contextChange(){this._clearColorCache=[0,0,0,0],this._viewPortCache=new n["a"]}copyToTexture(e,t,r,n,s){const a=this._renderTargetSystem,i=this._renderer,o=a.getGpuRenderTarget(e),c=i.gl;return this.finishRenderPass(e),c.bindFramebuffer(c.FRAMEBUFFER,o.resolveTargetFramebuffer),i.texture.bind(t,0),c.copyTexSubImage2D(c.TEXTURE_2D,0,s.x,s.y,r.x,r.y,n.width,n.height),t}startRenderPass(e){let t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],r=arguments.length>2?arguments[2]:void 0,n=arguments.length>3?arguments[3]:void 0;const s=this._renderTargetSystem,a=e.colorTexture,i=s.getGpuRenderTarget(e);let o=n.y;e.isRoot&&(o=a.pixelHeight-n.height),e.colorTextures.forEach(e=>{this._renderer.texture.unbind(e)});const c=this._renderer.gl;c.bindFramebuffer(c.FRAMEBUFFER,i.framebuffer);const u=this._viewPortCache;u.x===n.x&&u.y===o&&u.width===n.width&&u.height===n.height||(u.x=n.x,u.y=o,u.width=n.width,u.height=n.height,c.viewport(n.x,o,n.width,n.height)),i.depthStencilRenderBuffer||!e.stencil&&!e.depth||this._initStencil(i),this.clear(e,t,r)}finishRenderPass(e){const t=this._renderTargetSystem,r=t.getGpuRenderTarget(e);if(!r.msaa)return;const n=this._renderer.gl;n.bindFramebuffer(n.FRAMEBUFFER,r.resolveTargetFramebuffer),n.bindFramebuffer(n.READ_FRAMEBUFFER,r.framebuffer),n.blitFramebuffer(0,0,r.width,r.height,0,0,r.width,r.height,n.COLOR_BUFFER_BIT,n.NEAREST),n.bindFramebuffer(n.FRAMEBUFFER,r.framebuffer)}initGpuRenderTarget(e){const t=this._renderer,r=t.gl,n=new i["a"];return e.colorTexture.resource===t.gl.canvas?(n.framebuffer=null,n):(this._initColor(e,n),r.bindFramebuffer(r.FRAMEBUFFER,null),n)}destroyGpuRenderTarget(e){const t=this._renderer.gl;e.framebuffer&&(t.deleteFramebuffer(e.framebuffer),e.framebuffer=null),e.resolveTargetFramebuffer&&(t.deleteFramebuffer(e.resolveTargetFramebuffer),e.resolveTargetFramebuffer=null),e.depthStencilRenderBuffer&&(t.deleteRenderbuffer(e.depthStencilRenderBuffer),e.depthStencilRenderBuffer=null),e.msaaRenderBuffer.forEach(e=>{t.deleteRenderbuffer(e)}),e.msaaRenderBuffer=null}clear(e,t,r){if(!t)return;const n=this._renderTargetSystem;"boolean"===typeof t&&(t=t?a["a"].ALL:a["a"].NONE);const s=this._renderer.gl;if(t&a["a"].COLOR){var i;null!==(i=r)&&void 0!==i||(r=n.defaultClearColor);const e=this._clearColorCache,t=r;e[0]===t[0]&&e[1]===t[1]&&e[2]===t[2]&&e[3]===t[3]||(e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],s.clearColor(t[0],t[1],t[2],t[3]))}s.clear(t)}resizeGpuRenderTarget(e){if(e.isRoot)return;const t=this._renderTargetSystem,r=t.getGpuRenderTarget(e);this._resizeColor(e,r),e.stencil&&this._resizeStencil(r)}_initColor(e,t){const r=this._renderer,n=r.gl,a=n.createFramebuffer();if(t.resolveTargetFramebuffer=a,n.bindFramebuffer(n.FRAMEBUFFER,a),t.width=e.colorTexture.source.pixelWidth,t.height=e.colorTexture.source.pixelHeight,e.colorTextures.forEach((e,a)=>{const i=e.source;i.antialias&&(r.context.supports.msaa?t.msaa=!0:Object(s["a"])("[RenderTexture] Antialiasing on textures is not supported in WebGL1")),r.texture.bindSource(i,0);const o=r.texture.getGlSource(i),c=o.texture;n.framebufferTexture2D(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+a,3553,c,0)}),t.msaa){const r=n.createFramebuffer();t.framebuffer=r,n.bindFramebuffer(n.FRAMEBUFFER,r),e.colorTextures.forEach((e,r)=>{const s=n.createRenderbuffer();t.msaaRenderBuffer[r]=s})}else t.framebuffer=a;this._resizeColor(e,t)}_resizeColor(e,t){const r=e.colorTexture.source;if(t.width=r.pixelWidth,t.height=r.pixelHeight,e.colorTextures.forEach((e,t)=>{0!==t&&e.source.resize(r.width,r.height,r._resolution)}),t.msaa){const r=this._renderer,n=r.gl,s=t.framebuffer;n.bindFramebuffer(n.FRAMEBUFFER,s),e.colorTextures.forEach((e,s)=>{const a=e.source;r.texture.bindSource(a,0);const i=r.texture.getGlSource(a),o=i.internalFormat,c=t.msaaRenderBuffer[s];n.bindRenderbuffer(n.RENDERBUFFER,c),n.renderbufferStorageMultisample(n.RENDERBUFFER,4,o,a.pixelWidth,a.pixelHeight),n.framebufferRenderbuffer(n.FRAMEBUFFER,n.COLOR_ATTACHMENT0+s,n.RENDERBUFFER,c)})}}_initStencil(e){if(null===e.framebuffer)return;const t=this._renderer.gl,r=t.createRenderbuffer();e.depthStencilRenderBuffer=r,t.bindRenderbuffer(t.RENDERBUFFER,r),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,r),this._resizeStencil(e)}_resizeStencil(e){const t=this._renderer.gl;t.bindRenderbuffer(t.RENDERBUFFER,e.depthStencilRenderBuffer),e.msaa?t.renderbufferStorageMultisample(t.RENDERBUFFER,4,t.DEPTH24_STENCIL8,e.width,e.height):t.renderbufferStorage(t.RENDERBUFFER,2===this._renderer.context.webGLVersion?t.DEPTH24_STENCIL8:t.DEPTH_STENCIL,e.width,e.height)}}},"4b87":function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("fa73"),s=r("8cbc"),a=r("0a79"),i=r("6f6c"),o=r("3f58"),c=r("f172"),u=r("cb48"),l=r("07d6"),_=r("c1ba");class f{constructor(){this._didUpload=!1,this._tempState=l["a"].for2d()}init(e){const t=Object(s["a"])({name:"batch",bits:[a["b"],Object(i["b"])(_["a"]),o["b"]]});this._shader=new u["a"]({glProgram:t,resources:{batchSamplers:c["a"]}}),e.renderer.runners.contextChange.add(this)}contextChange(){this._didUpload=!1}start(e,t){const r=e.renderer;r.shader.bind(this._shader,this._didUpload),r.shader.updateUniformGroup(r.globalUniforms.uniformGroup),r.geometry.bind(t,this._shader.glProgram)}execute(e,t){const r=e.renderer;this._didUpload=!0,this._tempState.blendMode=t.blendMode,r.state.set(this._tempState);const n=t.textures.textures;for(let s=0;s<n.length;s++)r.texture.bind(n[s],s);r.geometry.draw("triangle-list",t.size,t.start)}destroy(){this._shader.destroy(!0),this._shader=null}}f.extension={type:[n["a"].WebGLPipesAdaptor],name:"batch"}},"4c7f":function(e,t,r){"use strict";r.d(t,"a",(function(){return c}));r("d9e2"),r("14d9");var n=r("fa73"),s=r("fc89"),a=r("dcb4"),i=r("5985");const o={"point-list":0,"line-list":1,"line-strip":3,"triangle-list":4,"triangle-strip":5};class c{constructor(e){this._geometryVaoHash=Object.create(null),this._renderer=e,this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0}contextChange(){const e=this.gl=this._renderer.gl;if(!this._renderer.context.supports.vertexArrayObject)throw new Error("[PixiJS] Vertex Array Objects are not supported on this device");const t=this._renderer.context.extensions.vertexArrayObject;t&&(e.createVertexArray=()=>t.createVertexArrayOES(),e.bindVertexArray=e=>t.bindVertexArrayOES(e),e.deleteVertexArray=e=>t.deleteVertexArrayOES(e));const r=this._renderer.context.extensions.vertexAttribDivisorANGLE;r&&(e.drawArraysInstanced=(e,t,n,s)=>{r.drawArraysInstancedANGLE(e,t,n,s)},e.drawElementsInstanced=(e,t,n,s,a)=>{r.drawElementsInstancedANGLE(e,t,n,s,a)},e.vertexAttribDivisor=(e,t)=>r.vertexAttribDivisorANGLE(e,t)),this._activeGeometry=null,this._activeVao=null,this._geometryVaoHash=Object.create(null)}bind(e,t){const r=this.gl;this._activeGeometry=e;const n=this.getVao(e,t);this._activeVao!==n&&(this._activeVao=n,r.bindVertexArray(n)),this.updateBuffers()}reset(){this.unbind()}updateBuffers(){const e=this._activeGeometry,t=this._renderer.buffer;for(let r=0;r<e.buffers.length;r++){const n=e.buffers[r];t.updateBuffer(n)}}checkCompatibility(e,t){const r=e.attributes,n=t._attributeData;for(const s in n)if(!r[s])throw new Error(`shader and geometry incompatible, geometry missing the "${s}" attribute`)}getSignature(e,t){const r=e.attributes,n=t._attributeData,s=["g",e.uid];for(const a in r)n[a]&&s.push(a,n[a].location);return s.join("-")}getVao(e,t){var r;return(null===(r=this._geometryVaoHash[e.uid])||void 0===r?void 0:r[t._key])||this.initGeometryVao(e,t)}initGeometryVao(e,t){const r=this._renderer.gl,n=this._renderer.buffer;this._renderer.shader._getProgramData(t),this.checkCompatibility(e,t);const s=this.getSignature(e,t);this._geometryVaoHash[e.uid]||(this._geometryVaoHash[e.uid]=Object.create(null),e.on("destroy",this.onGeometryDestroy,this));const i=this._geometryVaoHash[e.uid];let o=i[s];if(o)return i[t._key]=o,o;Object(a["a"])(e,t._attributeData);const c=e.buffers;o=r.createVertexArray(),r.bindVertexArray(o);for(let a=0;a<c.length;a++){const e=c[a];n.bind(e)}return this.activateVao(e,t),i[t._key]=o,i[s]=o,r.bindVertexArray(null),o}onGeometryDestroy(e,t){const r=this._geometryVaoHash[e.uid],n=this.gl;if(r){if(t)for(const e in r)this._activeVao!==r[e]&&this.unbind(),n.deleteVertexArray(r[e]);this._geometryVaoHash[e.uid]=null}}destroyAll(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];const t=this.gl;for(const r in this._geometryVaoHash){if(e)for(const e in this._geometryVaoHash[r]){const n=this._geometryVaoHash[r];this._activeVao!==n&&this.unbind(),t.deleteVertexArray(n[e])}this._geometryVaoHash[r]=null}}activateVao(e,t){const r=this._renderer.gl,n=this._renderer.buffer,a=e.attributes;e.indexBuffer&&n.bind(e.indexBuffer);let o=null;for(const u in a){const e=a[u],l=e.buffer,_=n.getGlBuffer(l),f=t._attributeData[u];if(f){var c;o!==_&&(n.bind(l),o=_);const t=e.location;r.enableVertexAttribArray(t);const a=Object(s["a"])(e.format),u=Object(i["a"])(e.format);if("int"===(null===(c=f.format)||void 0===c?void 0:c.substring(1,4))?r.vertexAttribIPointer(t,a.size,u,e.stride,e.offset):r.vertexAttribPointer(t,a.size,u,a.normalised,e.stride,e.offset),e.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");r.vertexAttribDivisor(t,1)}}}}draw(e,t,r,n){const{gl:s}=this._renderer,a=this._activeGeometry,i=o[a.topology||e];if(n||(n=a.instanceCount),a.indexBuffer){const e=a.indexBuffer.data.BYTES_PER_ELEMENT,o=2===e?s.UNSIGNED_SHORT:s.UNSIGNED_INT;n>1?s.drawElementsInstanced(i,t||a.indexBuffer.data.length,o,(r||0)*e,n):s.drawElements(i,t||a.indexBuffer.data.length,o,(r||0)*e)}else n>1?s.drawArraysInstanced(i,r||0,t||a.getSize(),n):s.drawArrays(i,r||0,t||a.getSize());return this}unbind(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null}destroy(){this._renderer=null,this.gl=null,this._activeVao=null,this._activeGeometry=null}}c.extension={type:[n["a"].WebGLSystem],name:"geometry"}},"4d70":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("3440");function s(e,t){const r=Math.max(n["a"][e.data.type]/16,1),s=e.data.value.length/e.data.size,a=(4-s%4)%4;return`\n        v = uv.${e.data.name};\n        offset += ${t};\n\n        arrayOffset = offset;\n\n        t = 0;\n\n        for(var i=0; i < ${e.data.size*r}; i++)\n        {\n            for(var j = 0; j < ${s}; j++)\n            {\n                data[arrayOffset++] = v[t++];\n            }\n            ${0!==a?`arrayOffset += ${a};`:""}\n        }\n    `}},"53ef":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));r("14d9");function n(e,t){const r=e.getShaderSource(t).split("\n").map((e,t)=>`${t}: ${e}`),n=e.getShaderInfoLog(t),s=n.split("\n"),a={},i=s.map(e=>parseFloat(e.replace(/^ERROR\: 0\:([\d]+)\:.*$/,"$1"))).filter(e=>!(!e||a[e])&&(a[e]=!0,!0)),o=[""];i.forEach(e=>{r[e-1]=`%c${r[e-1]}%c`,o.push("background: #FF0000; color:#FFFFFF; font-size: 10px","font-size: 10px")});const c=r.join("\n");o[0]=c,console.error(n),console.groupCollapsed("click to view full shader code"),console.warn(...o),console.groupEnd()}function s(e,t,r,s){e.getProgramParameter(t,e.LINK_STATUS)||(e.getShaderParameter(r,e.COMPILE_STATUS)||n(e,r),e.getShaderParameter(s,e.COMPILE_STATUS)||n(e,s),console.error("PixiJS Error: Could not initialize shader."),""!==e.getProgramInfoLog(t)&&console.warn("PixiJS Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(t)))}},5519:function(e,t,r){"use strict";function n(e){return{r8unorm:e.RED,r8snorm:e.RED,r8uint:e.RED,r8sint:e.RED,r16uint:e.RED,r16sint:e.RED,r16float:e.RED,rg8unorm:e.RG,rg8snorm:e.RG,rg8uint:e.RG,rg8sint:e.RG,r32uint:e.RED,r32sint:e.RED,r32float:e.RED,rg16uint:e.RG,rg16sint:e.RG,rg16float:e.RG,rgba8unorm:e.RGBA,"rgba8unorm-srgb":e.RGBA,rgba8snorm:e.RGBA,rgba8uint:e.RGBA,rgba8sint:e.RGBA,bgra8unorm:e.RGBA,"bgra8unorm-srgb":e.RGBA,rgb9e5ufloat:e.RGB,rgb10a2unorm:e.RGBA,rg11b10ufloat:e.RGB,rg32uint:e.RG,rg32sint:e.RG,rg32float:e.RG,rgba16uint:e.RGBA,rgba16sint:e.RGBA,rgba16float:e.RGBA,rgba32uint:e.RGBA,rgba32sint:e.RGBA,rgba32float:e.RGBA,stencil8:e.STENCIL_INDEX8,depth16unorm:e.DEPTH_COMPONENT,depth24plus:e.DEPTH_COMPONENT,"depth24plus-stencil8":e.DEPTH_STENCIL,depth32float:e.DEPTH_COMPONENT,"depth32float-stencil8":e.DEPTH_STENCIL}}r.d(t,"a",(function(){return n}))},"567e":function(e,t,r){"use strict";function n(e){return{r8unorm:e.UNSIGNED_BYTE,r8snorm:e.BYTE,r8uint:e.UNSIGNED_BYTE,r8sint:e.BYTE,r16uint:e.UNSIGNED_SHORT,r16sint:e.SHORT,r16float:e.HALF_FLOAT,rg8unorm:e.UNSIGNED_BYTE,rg8snorm:e.BYTE,rg8uint:e.UNSIGNED_BYTE,rg8sint:e.BYTE,r32uint:e.UNSIGNED_INT,r32sint:e.INT,r32float:e.FLOAT,rg16uint:e.UNSIGNED_SHORT,rg16sint:e.SHORT,rg16float:e.HALF_FLOAT,rgba8unorm:e.UNSIGNED_BYTE,"rgba8unorm-srgb":e.UNSIGNED_BYTE,rgba8snorm:e.BYTE,rgba8uint:e.UNSIGNED_BYTE,rgba8sint:e.BYTE,bgra8unorm:e.UNSIGNED_BYTE,"bgra8unorm-srgb":e.UNSIGNED_BYTE,rgb9e5ufloat:e.UNSIGNED_INT_5_9_9_9_REV,rgb10a2unorm:e.UNSIGNED_INT_2_10_10_10_REV,rg11b10ufloat:e.UNSIGNED_INT_10F_11F_11F_REV,rg32uint:e.UNSIGNED_INT,rg32sint:e.INT,rg32float:e.FLOAT,rgba16uint:e.UNSIGNED_SHORT,rgba16sint:e.SHORT,rgba16float:e.HALF_FLOAT,rgba32uint:e.UNSIGNED_INT,rgba32sint:e.INT,rgba32float:e.FLOAT,stencil8:e.UNSIGNED_BYTE,depth16unorm:e.UNSIGNED_SHORT,depth24plus:e.UNSIGNED_INT,"depth24plus-stencil8":e.UNSIGNED_INT_24_8,depth32float:e.FLOAT,"depth32float-stencil8":e.FLOAT_32_UNSIGNED_INT_24_8_REV}}r.d(t,"a",(function(){return n}))},5985:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("f50e");const s={uint8x2:n["c"].UNSIGNED_BYTE,uint8x4:n["c"].UNSIGNED_BYTE,sint8x2:n["c"].BYTE,sint8x4:n["c"].BYTE,unorm8x2:n["c"].UNSIGNED_BYTE,unorm8x4:n["c"].UNSIGNED_BYTE,snorm8x2:n["c"].BYTE,snorm8x4:n["c"].BYTE,uint16x2:n["c"].UNSIGNED_SHORT,uint16x4:n["c"].UNSIGNED_SHORT,sint16x2:n["c"].SHORT,sint16x4:n["c"].SHORT,unorm16x2:n["c"].UNSIGNED_SHORT,unorm16x4:n["c"].UNSIGNED_SHORT,snorm16x2:n["c"].SHORT,snorm16x4:n["c"].SHORT,float16x2:n["c"].HALF_FLOAT,float16x4:n["c"].HALF_FLOAT,float32:n["c"].FLOAT,float32x2:n["c"].FLOAT,float32x3:n["c"].FLOAT,float32x4:n["c"].FLOAT,uint32:n["c"].UNSIGNED_INT,uint32x2:n["c"].UNSIGNED_INT,uint32x3:n["c"].UNSIGNED_INT,uint32x4:n["c"].UNSIGNED_INT,sint32:n["c"].INT,sint32x2:n["c"].INT,sint32x3:n["c"].INT,sint32x4:n["c"].INT};function a(e){var t;return null!==(t=s[e])&&void 0!==t?t:s.float32}},"5d77":function(e,t,r){"use strict";function n(e,t,r){const n=e.createShader(t);return e.shaderSource(n,r),e.compileShader(n),n}r.d(t,"a",(function(){return n}))},"63bc":function(e,t,r){"use strict";function n(e,t){if(!t.ACTIVE_UNIFORM_BLOCKS)return{};const r={},n=t.getProgramParameter(e,t.ACTIVE_UNIFORM_BLOCKS);for(let s=0;s<n;s++){const n=t.getActiveUniformBlockName(e,s),a=t.getUniformBlockIndex(e,n),i=t.getActiveUniformBlockParameter(e,s,t.UNIFORM_BLOCK_DATA_SIZE);r[n]={name:n,index:a,size:i}}return r}r.d(t,"a",(function(){return n}))},"6cdb":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.buffer=e||null,this.updateID=-1,this.byteLength=-1,this.type=t}}},7995:function(e,t,r){"use strict";r.d(t,"a",(function(){return i})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return n})),r.d(t,"d",(function(){return a}));const n={linear:9729,nearest:9728},s={linear:{linear:9987,nearest:9985},nearest:{linear:9986,nearest:9984}},a={"clamp-to-edge":33071,repeat:10497,"mirror-repeat":33648},i={never:512,less:513,equal:514,"less-equal":515,greater:516,"not-equal":517,"greater-equal":518,always:519}},"7a4f":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));var n=(e=>(e[e["ELEMENT_ARRAY_BUFFER"]=34963]="ELEMENT_ARRAY_BUFFER",e[e["ARRAY_BUFFER"]=34962]="ARRAY_BUFFER",e[e["UNIFORM_BUFFER"]=35345]="UNIFORM_BUFFER",e))(n||{})},"7c8a":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fa73"),s=r("2911"),a=r("b23e");const i={textureCount:0,blockIndex:0};class o{constructor(e){this._activeProgram=null,this._programDataHash=Object.create(null),this._nextIndex=0,this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._shaderSyncFunctions=Object.create(null),this._renderer=e}contextChange(e){this._gl=e,this._maxBindings=e.MAX_UNIFORM_BUFFER_BINDINGS?e.getParameter(e.MAX_UNIFORM_BUFFER_BINDINGS):0,this._programDataHash=Object.create(null),this._boundUniformsIdsToIndexHash=Object.create(null),this._boundIndexToUniformsHash=Object.create(null),this._activeProgram=null}bind(e,t){if(this._setProgram(e.glProgram),t)return;i.textureCount=0,i.blockIndex=0;let r=this._shaderSyncFunctions[e.glProgram._key];r||(r=this._shaderSyncFunctions[e.glProgram._key]=this._generateShaderSync(e,this)),r(this._renderer,e,i)}updateUniformGroup(e){this._renderer.uniformGroup.updateUniformGroup(e,this._activeProgram,i)}bindUniformBlock(e,t){let r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0;const n=this._renderer.buffer,s=this._getProgramData(this._activeProgram),a=e._bufferResource;a&&this._renderer.ubo.updateUniformGroup(e),n.updateBuffer(e.buffer);let i=this._boundUniformsIdsToIndexHash[e.uid];if(void 0===i){const t=this._nextIndex++%this._maxBindings,r=this._boundIndexToUniformsHash[t];r&&(this._boundUniformsIdsToIndexHash[r.uid]=void 0),i=this._boundUniformsIdsToIndexHash[e.uid]=t,this._boundIndexToUniformsHash[t]=e,a?n.bindBufferRange(e.buffer,t,e.offset):n.bindBufferBase(e.buffer,t)}const o=this._gl,c=this._activeProgram._uniformBlockData[t].index;s.uniformBlockBindings[r]!==i&&(s.uniformBlockBindings[r]=i,o.uniformBlockBinding(s.program,c,i))}_setProgram(e){if(this._activeProgram===e)return;this._activeProgram=e;const t=this._getProgramData(e);this._gl.useProgram(t.program)}_getProgramData(e){return this._programDataHash[e._key]||this._createProgramData(e)}_createProgramData(e){const t=e._key;return this._programDataHash[t]=Object(a["a"])(this._gl,e),this._programDataHash[t]}destroy(){for(const e of Object.keys(this._programDataHash)){const t=this._programDataHash[e];t.destroy(),this._programDataHash[e]=null}this._programDataHash=null,this._boundUniformsIdsToIndexHash=null}_generateShaderSync(e,t){return Object(s["a"])(e,t)}}o.extension={type:[n["a"].WebGLSystem],name:"shader"}},"85c4":function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));var n=r("fa73"),s=r("1103"),a=r("7a4f"),i=r("6cdb");class o{constructor(e){this._gpuBuffers=Object.create(null),this._boundBufferBases=Object.create(null),this._renderer=e}destroy(){this._renderer=null,this._gl=null,this._gpuBuffers=null,this._boundBufferBases=null}contextChange(){this._gpuBuffers=Object.create(null),this._gl=this._renderer.gl}getGlBuffer(e){return this._gpuBuffers[e.uid]||this.createGLBuffer(e)}bind(e){const{_gl:t}=this,r=this.getGlBuffer(e);t.bindBuffer(r.type,r.buffer)}bindBufferBase(e,t){const{_gl:r}=this;if(this._boundBufferBases[t]!==e){const n=this.getGlBuffer(e);this._boundBufferBases[t]=e,r.bindBufferBase(r.UNIFORM_BUFFER,t,n.buffer)}}bindBufferRange(e,t,r){const{_gl:n}=this;r=r||0;const s=this.getGlBuffer(e);n.bindBufferRange(n.UNIFORM_BUFFER,t||0,s.buffer,256*r,256)}updateBuffer(e){const{_gl:t}=this,r=this.getGlBuffer(e);if(e._updateID===r.updateID)return r;r.updateID=e._updateID,t.bindBuffer(r.type,r.buffer);const n=e.data;if(r.byteLength>=e.data.byteLength)t.bufferSubData(r.type,0,n,0,e._updateSize/n.BYTES_PER_ELEMENT);else{const a=e.descriptor.usage&s["a"].STATIC?t.STATIC_DRAW:t.DYNAMIC_DRAW;r.byteLength=n.byteLength,t.bufferData(r.type,n,a)}return r}destroyAll(){const e=this._gl;for(const t in this._gpuBuffers)e.deleteBuffer(this._gpuBuffers[t].buffer);this._gpuBuffers=Object.create(null)}onBufferDestroy(e,t){const r=this._gpuBuffers[e.uid],n=this._gl;t||n.deleteBuffer(r.buffer),this._gpuBuffers[e.uid]=null}createGLBuffer(e){const{_gl:t}=this;let r=a["a"].ARRAY_BUFFER;e.descriptor.usage&s["a"].INDEX?r=a["a"].ELEMENT_ARRAY_BUFFER:e.descriptor.usage&s["a"].UNIFORM&&(r=a["a"].UNIFORM_BUFFER);const n=new i["a"](t.createBuffer(),r);return this._gpuBuffers[e.uid]=n,e.on("destroy",this.onBufferDestroy,this),n}}o.extension={type:[n["a"].WebGLSystem],name:"buffer"}},"86de":function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));const n={"bc1-rgba-unorm":!0,"bc1-rgba-unorm-srgb":!0,"bc2-rgba-unorm":!0,"bc2-rgba-unorm-srgb":!0,"bc3-rgba-unorm":!0,"bc3-rgba-unorm-srgb":!0,"bc4-r-unorm":!0,"bc4-r-snorm":!0,"bc5-rg-unorm":!0,"bc5-rg-snorm":!0,"bc6h-rgb-ufloat":!0,"bc6h-rgb-float":!0,"bc7-rgba-unorm":!0,"bc7-rgba-unorm-srgb":!0,"etc2-rgb8unorm":!0,"etc2-rgb8unorm-srgb":!0,"etc2-rgb8a1unorm":!0,"etc2-rgb8a1unorm-srgb":!0,"etc2-rgba8unorm":!0,"etc2-rgba8unorm-srgb":!0,"eac-r11unorm":!0,"eac-r11snorm":!0,"eac-rg11unorm":!0,"eac-rg11snorm":!0,"astc-4x4-unorm":!0,"astc-4x4-unorm-srgb":!0,"astc-5x4-unorm":!0,"astc-5x4-unorm-srgb":!0,"astc-5x5-unorm":!0,"astc-5x5-unorm-srgb":!0,"astc-6x5-unorm":!0,"astc-6x5-unorm-srgb":!0,"astc-6x6-unorm":!0,"astc-6x6-unorm-srgb":!0,"astc-8x5-unorm":!0,"astc-8x5-unorm-srgb":!0,"astc-8x6-unorm":!0,"astc-8x6-unorm-srgb":!0,"astc-8x8-unorm":!0,"astc-8x8-unorm-srgb":!0,"astc-10x5-unorm":!0,"astc-10x5-unorm-srgb":!0,"astc-10x6-unorm":!0,"astc-10x6-unorm-srgb":!0,"astc-10x8-unorm":!0,"astc-10x8-unorm-srgb":!0,"astc-10x10-unorm":!0,"astc-10x10-unorm-srgb":!0,"astc-12x10-unorm":!0,"astc-12x10-unorm-srgb":!0,"astc-12x12-unorm":!0,"astc-12x12-unorm-srgb":!0},s={id:"compressed",upload(e,t,r){r.pixelStorei(r.UNPACK_ALIGNMENT,4);let s=e.pixelWidth,a=e.pixelHeight;const i=!!n[e.format];for(let n=0;n<e.resource.length;n++){const o=e.resource[n];i?r.compressedTexImage2D(r.TEXTURE_2D,n,t.internalFormat,s,a,0,o):r.texImage2D(r.TEXTURE_2D,n,t.internalFormat,s,a,0,t.format,t.type,o),s=Math.max(s>>1,1),a=Math.max(a>>1,1)}}}},8753:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));var n=r("fa73"),s=r("2a40"),a=r("c0bf"),i=r("cb48"),o=r("07d6"),c=r("8591"),u=r("af3f"),l=r("aedf");const _=new a["a"]({attributes:{aPosition:[-1,-1,3,-1,-1,3]}}),f=class e{constructor(e){this.useBackBuffer=!1,this._useBackBufferThisRender=!1,this._renderer=e}init(){let t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};const{useBackBuffer:r,antialias:n}={...e.defaultOptions,...t};this.useBackBuffer=r,this._antialias=n,this._renderer.context.supports.msaa||(Object(s["a"])("antialiasing, is not supported on when using the back buffer"),this._antialias=!1),this._state=o["a"].for2d();const a=new l["a"]({vertex:"\n                attribute vec2 aPosition;\n                out vec2 vUv;\n\n                void main() {\n                    gl_Position = vec4(aPosition, 0.0, 1.0);\n\n                    vUv = (aPosition + 1.0) / 2.0;\n\n                    // flip dem UVs\n                    vUv.y = 1.0 - vUv.y;\n                }",fragment:"\n                in vec2 vUv;\n                out vec4 finalColor;\n\n                uniform sampler2D uTexture;\n\n                void main() {\n                    finalColor = texture(uTexture, vUv);\n                }",name:"big-triangle"});this._bigTriangleShader=new i["a"]({glProgram:a,resources:{uTexture:u["a"].WHITE.source}})}renderStart(e){const t=this._renderer.renderTarget.getRenderTarget(e.target);if(this._useBackBufferThisRender=this.useBackBuffer&&!!t.isRoot,this._useBackBufferThisRender){const t=this._renderer.renderTarget.getRenderTarget(e.target);this._targetTexture=t.colorTexture,e.target=this._getBackBufferTexture(t.colorTexture)}}renderEnd(){this._presentBackBuffer()}_presentBackBuffer(){const e=this._renderer;e.renderTarget.finishRenderPass(),this._useBackBufferThisRender&&(e.renderTarget.bind(this._targetTexture,!1),this._bigTriangleShader.resources.uTexture=this._backBufferTexture.source,e.encoder.draw({geometry:_,shader:this._bigTriangleShader,state:this._state}))}_getBackBufferTexture(e){return this._backBufferTexture=this._backBufferTexture||new u["a"]({source:new c["a"]({width:e.width,height:e.height,resolution:e._resolution,antialias:this._antialias})}),this._backBufferTexture.source.resize(e.width,e.height,e._resolution),this._backBufferTexture}destroy(){this._backBufferTexture&&(this._backBufferTexture.destroy(),this._backBufferTexture=null)}};f.extension={type:[n["a"].WebGLSystem],name:"backBuffer",priority:1},f.defaultOptions={useBackBuffer:!1};let d=f},"8a98":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(e,t){this.program=e,this.uniformData=t,this.uniformGroups={},this.uniformDirtyGroups={},this.uniformBlockBindings={}}destroy(){this.uniformData=null,this.uniformGroups=null,this.uniformDirtyGroups=null,this.uniformBlockBindings=null,this.program=null}}},"8fa2":function(e,t,r){"use strict";r.d(t,"a",(function(){return f}));var n=r("fa73"),s=r("2714"),a=r("8cbc"),i=r("39bc"),o=r("3f58"),c=r("dcdc"),u=r("cb48"),l=r("af3f"),_=r("2a40");class f{init(){const e=Object(a["a"])({name:"mesh",bits:[i["b"],c["b"],o["b"]]});this._shader=new u["a"]({glProgram:e,resources:{uTexture:l["a"].EMPTY.source,textureUniforms:{uTextureMatrix:{type:"mat3x3<f32>",value:new s["a"]}}}})}execute(e,t){const r=e.renderer;let n=t._shader;if(n){if(!n.glProgram)return void Object(_["a"])("Mesh shader has no glProgram",t.shader)}else{n=this._shader;const e=t.texture,r=e.source;n.resources.uTexture=r,n.resources.uSampler=r.style,n.resources.textureUniforms.uniforms.uTextureMatrix=e.textureMatrix.mapCoord}n.groups[100]=r.globalUniforms.bindGroup,n.groups[101]=e.localUniformsBindGroup,r.encoder.draw({geometry:t._geometry,shader:n,state:t.state})}destroy(){this._shader.destroy(!0),this._shader=null}}f.extension={type:[n["a"].WebGLPipesAdaptor],name:"mesh"}},"8fa4":function(e,t,r){"use strict";r.d(t,"a",(function(){return h}));r("907a"),r("986a"),r("1d02"),r("3c5d"),r("1b3b"),r("3d71"),r("c6e3");var n=r("fa73"),s=r("2714"),a=r("c1ba"),i=r("8cbc"),o=r("0a79"),c=r("6f6c"),u=r("39bc"),l=r("3f58"),_=r("f172"),f=r("cb48"),d=r("3456");class h{init(){const e=new d["a"]({uColor:{value:new Float32Array([1,1,1,1]),type:"vec4<f32>"},uTransformMatrix:{value:new s["a"],type:"mat3x3<f32>"},uRound:{value:0,type:"f32"}}),t=Object(i["a"])({name:"graphics",bits:[o["b"],Object(c["b"])(a["a"]),u["b"],l["b"]]});this.shader=new f["a"]({glProgram:t,resources:{localUniforms:e,batchSamplers:_["a"]}})}execute(e,t){const r=t.context,n=r.customShader||this.shader,s=e.renderer,a=s.graphicsContext,{geometry:i,instructions:o}=a.getContextRenderData(r);n.groups[0]=s.globalUniforms.bindGroup,s.state.set(e.state),s.shader.bind(n),s.geometry.bind(i,n.glProgram);const c=o.instructions;for(let u=0;u<o.instructionSize;u++){const e=c[u];if(e.size){for(let t=0;t<e.textures.textures.length;t++)s.texture.bind(e.textures.textures[t],t);s.geometry.draw("triangle-list",e.size,e.start)}}}destroy(){this.shader.destroy(!0),this.shader=null}}h.extension={type:[n["a"].WebGLPipesAdaptor],name:"graphics"}},"92be":function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));class n{constructor(){this.width=-1,this.height=-1,this.msaa=!1,this.msaaRenderBuffer=[]}}},a582:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("fa73");class s{constructor(e){this._colorMaskCache=15,this._renderer=e}setMask(e){this._colorMaskCache!==e&&(this._colorMaskCache=e,this._renderer.gl.colorMask(!!(8&e),!!(4&e),!!(2&e),!!(1&e)))}}s.extension={type:[n["a"].WebGLSystem],name:"colorMask"}},aae5:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));r("14d9");var n=r("fa73"),s=r("20dd");class a{constructor(e){this._cache={},this._uniformGroupSyncHash={},this._renderer=e,this.gl=null,this._cache={}}contextChange(e){this.gl=e}updateUniformGroup(e,t,r){const n=this._renderer.shader._getProgramData(t);if(!e.isStatic||e._dirtyId!==n.uniformDirtyGroups[e.uid]){n.uniformDirtyGroups[e.uid]=e._dirtyId;const s=this._getUniformSyncFunction(e,t);s(n.uniformData,e.uniforms,this._renderer,r)}}_getUniformSyncFunction(e,t){var r;return(null===(r=this._uniformGroupSyncHash[e._signature])||void 0===r?void 0:r[t._key])||this._createUniformSyncFunction(e,t)}_createUniformSyncFunction(e,t){const r=this._uniformGroupSyncHash[e._signature]||(this._uniformGroupSyncHash[e._signature]={}),n=this._getSignature(e,t._uniformData,"u");return this._cache[n]||(this._cache[n]=this._generateUniformsSync(e,t._uniformData)),r[t._key]=this._cache[n],r[t._key]}_generateUniformsSync(e,t){return Object(s["a"])(e,t)}_getSignature(e,t,r){const n=e.uniforms,s=[r+"-"];for(const a in n)s.push(a),t[a]&&s.push(t[a].type);return s.join("-")}destroy(){this._renderer=null,this._cache=null}}a.extension={type:[n["a"].WebGLSystem],name:"uniformGroup"}},b23e:function(e,t,r){"use strict";r.d(t,"a",(function(){return _}));var n=r("2a40"),s=r("8a98"),a=r("5d77"),i=r("1f03"),o=r("c79c"),c=r("63bc"),u=r("e6ba"),l=r("53ef");function _(e,t){const r=Object(a["a"])(e,e.VERTEX_SHADER,t.vertex),_=Object(a["a"])(e,e.FRAGMENT_SHADER,t.fragment),f=e.createProgram();e.attachShader(f,r),e.attachShader(f,_);const d=t.transformFeedbackVaryings;d&&("function"!==typeof e.transformFeedbackVaryings?Object(n["a"])("TransformFeedback is not supported but TransformFeedbackVaryings are given."):e.transformFeedbackVaryings(f,d.names,"separate"===d.bufferMode?e.SEPARATE_ATTRIBS:e.INTERLEAVED_ATTRIBS)),e.linkProgram(f),e.getProgramParameter(f,e.LINK_STATUS)||Object(l["a"])(e,f,r,_),t._attributeData=Object(o["a"])(f,e,!/^[ \t]*#[ \t]*version[ \t]+300[ \t]+es[ \t]*$/m.test(t.vertex)),t._uniformData=Object(u["a"])(f,e),t._uniformBlockData=Object(c["a"])(f,e),e.deleteShader(r),e.deleteShader(_);const h={};for(const n in t._uniformData){const r=t._uniformData[n];h[n]={location:e.getUniformLocation(f,n),value:Object(i["a"])(r.type,r.size)}}const g=new s["a"](f,h);return g}},b716:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={id:"image",upload(e,t,r){t.width===e.width||t.height===e.height?r.texSubImage2D(r.TEXTURE_2D,0,0,0,t.format,t.type,e.resource):r.texImage2D(t.target,0,t.internalFormat,e.width,e.height,0,t.format,t.type,e.resource),t.width=e.width,t.height=e.height}}},c79c:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("fc89"),s=r("cba2");function a(e,t){let r=arguments.length>2&&void 0!==arguments[2]&&arguments[2];const a={},i=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES);for(let c=0;c<i;c++){const r=t.getActiveAttrib(e,c);if(r.name.startsWith("gl_"))continue;const i=Object(s["a"])(t,r.type);a[r.name]={location:0,format:i,stride:Object(n["a"])(i).stride,offset:0,instance:!1,start:0}}const o=Object.keys(a);if(r){o.sort((e,t)=>e>t?1:-1);for(let r=0;r<o.length;r++)a[o[r]].location=r,t.bindAttribLocation(e,r,o[r]);t.linkProgram(e)}else for(let n=0;n<o.length;n++)a[o[n]].location=t.getAttribLocation(e,o[n]);return a}},cba2:function(e,t,r){"use strict";r.d(t,"a",(function(){return o})),r.d(t,"b",(function(){return i}));let n=null;const s={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",UNSIGNED_INT:"uint",UNSIGNED_INT_VEC2:"uvec2",UNSIGNED_INT_VEC3:"uvec3",UNSIGNED_INT_VEC4:"uvec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",INT_SAMPLER_2D:"sampler2D",UNSIGNED_INT_SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",INT_SAMPLER_CUBE:"samplerCube",UNSIGNED_INT_SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray",INT_SAMPLER_2D_ARRAY:"sampler2DArray",UNSIGNED_INT_SAMPLER_2D_ARRAY:"sampler2DArray"},a={float:"float32",vec2:"float32x2",vec3:"float32x3",vec4:"float32x4",int:"sint32",ivec2:"sint32x2",ivec3:"sint32x3",ivec4:"sint32x4",uint:"uint32",uvec2:"uint32x2",uvec3:"uint32x3",uvec4:"uint32x4",bool:"uint32",bvec2:"uint32x2",bvec3:"uint32x3",bvec4:"uint32x4"};function i(e,t){if(!n){const t=Object.keys(s);n={};for(let r=0;r<t.length;++r){const a=t[r];n[e[a]]=s[a]}}return n[t]}function o(e,t){const r=i(e,t);return a[r]||"float32"}},cdc1:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));var n=r("fa73"),s=r("d12d"),a=r("9ca7");class i{constructor(e){this._stencilCache={enabled:!1,stencilReference:0,stencilMode:a["b"].NONE},this._renderTargetStencilState=Object.create(null),e.renderTarget.onRenderTargetChange.add(this)}contextChange(e){this._gl=e,this._comparisonFuncMapping={always:e.ALWAYS,never:e.NEVER,equal:e.EQUAL,"not-equal":e.NOTEQUAL,less:e.LESS,"less-equal":e.LEQUAL,greater:e.GREATER,"greater-equal":e.GEQUAL},this._stencilOpsMapping={keep:e.KEEP,zero:e.ZERO,replace:e.REPLACE,invert:e.INVERT,"increment-clamp":e.INCR,"decrement-clamp":e.DECR,"increment-wrap":e.INCR_WRAP,"decrement-wrap":e.DECR_WRAP},this._stencilCache.enabled=!1,this._stencilCache.stencilMode=a["b"].NONE,this._stencilCache.stencilReference=0}onRenderTargetChange(e){if(this._activeRenderTarget===e)return;this._activeRenderTarget=e;let t=this._renderTargetStencilState[e.uid];t||(t=this._renderTargetStencilState[e.uid]={stencilMode:a["b"].DISABLED,stencilReference:0}),this.setStencilMode(t.stencilMode,t.stencilReference)}setStencilMode(e,t){const r=this._renderTargetStencilState[this._activeRenderTarget.uid],n=this._gl,i=s["a"][e],o=this._stencilCache;r.stencilMode=e,r.stencilReference=t,e!==a["b"].DISABLED?(this._stencilCache.enabled||(this._stencilCache.enabled=!0,n.enable(n.STENCIL_TEST)),e===o.stencilMode&&o.stencilReference===t||(o.stencilMode=e,o.stencilReference=t,n.stencilFunc(this._comparisonFuncMapping[i.stencilBack.compare],t,255),n.stencilOp(n.KEEP,n.KEEP,this._stencilOpsMapping[i.stencilBack.passOp]))):this._stencilCache.enabled&&(this._stencilCache.enabled=!1,n.disable(n.STENCIL_TEST))}}i.extension={type:[n["a"].WebGLSystem],name:"stencil"}},ce4b:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("7995");function s(e,t,r,s,a,i,o,c){const u=i;if(!c||"repeat"!==e.addressModeU||"repeat"!==e.addressModeV||"repeat"!==e.addressModeW){const r=n["d"][o?"clamp-to-edge":e.addressModeU],s=n["d"][o?"clamp-to-edge":e.addressModeV],i=n["d"][o?"clamp-to-edge":e.addressModeW];t[a](u,t.TEXTURE_WRAP_S,r),t[a](u,t.TEXTURE_WRAP_T,s),t.TEXTURE_WRAP_R&&t[a](u,t.TEXTURE_WRAP_R,i)}if(c&&"linear"===e.magFilter||t[a](u,t.TEXTURE_MAG_FILTER,n["c"][e.magFilter]),r){if(!c||"linear"!==e.mipmapFilter){const r=n["b"][e.minFilter][e.mipmapFilter];t[a](u,t.TEXTURE_MIN_FILTER,r)}}else t[a](u,t.TEXTURE_MIN_FILTER,n["c"][e.minFilter]);if(s&&e.maxAnisotropy>1){const r=Math.min(e.maxAnisotropy,t.getParameter(s.MAX_TEXTURE_MAX_ANISOTROPY_EXT));t[a](u,s.TEXTURE_MAX_ANISOTROPY_EXT,r)}e.compare&&t[a](u,t.TEXTURE_COMPARE_FUNC,n["a"][e.compare])}},d355:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("f50e");class s{constructor(e){this.target=n["b"].TEXTURE_2D,this.texture=e,this.width=-1,this.height=-1,this.type=n["c"].UNSIGNED_BYTE,this.internalFormat=n["a"].RGBA,this.format=n["a"].RGBA,this.samplerType=0}}},d6d9:function(e,t,r){"use strict";r.d(t,"a",(function(){return n}));const n={id:"image",upload(e,t,r,n){const s="premultiply-alpha-on-upload"===e.alphaMode;r.pixelStorei(r.UNPACK_PREMULTIPLY_ALPHA_WEBGL,s);const a=t.width,i=t.height,o=e.pixelWidth,c=e.pixelHeight,u=e.resourceWidth,l=e.resourceHeight;u<o||l<c?(a===o&&i===c||r.texImage2D(t.target,0,t.internalFormat,o,c,0,t.format,t.type,null),2===n?r.texSubImage2D(r.TEXTURE_2D,0,0,0,u,l,t.format,t.type,e.resource):r.texSubImage2D(r.TEXTURE_2D,0,0,0,t.format,t.type,e.resource)):a===o||i===c?r.texSubImage2D(r.TEXTURE_2D,0,0,0,t.format,t.type,e.resource):2===n?r.texImage2D(t.target,0,t.internalFormat,o,c,0,t.format,t.type,e.resource):r.texImage2D(t.target,0,t.internalFormat,t.format,t.type,e.resource),t.width=o,t.height=c}}},ddd5:function(e,t,r){"use strict";function n(e){const t={};return t.normal=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t.add=[e.ONE,e.ONE],t.multiply=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.screen=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.none=[0,0],t["normal-npm"]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t["add-npm"]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t["screen-npm"]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t.erase=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t}r.d(t,"a",(function(){return n}))},e1eb:function(e,t,r){"use strict";r.d(t,"a",(function(){return d}));r("14d9");var n=r("fa73"),s=r("07d6"),a=r("ddd5");const i=0,o=1,c=2,u=3,l=4,_=5,f=class e{constructor(){this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode="none",this._blendEq=!1,this.map=[],this.map[i]=this.setBlend,this.map[o]=this.setOffset,this.map[c]=this.setCullFace,this.map[u]=this.setDepthTest,this.map[l]=this.setFrontFace,this.map[_]=this.setDepthMask,this.checks=[],this.defaultState=s["a"].for2d()}contextChange(e){this.gl=e,this.blendModesMap=Object(a["a"])(e),this.reset()}set(e){if(e=e||this.defaultState,this.stateId!==e.data){let t=this.stateId^e.data,r=0;while(t)1&t&&this.map[r].call(this,!!(e.data&1<<r)),t>>=1,r++;this.stateId=e.data}for(let t=0;t<this.checks.length;t++)this.checks[t](this,e)}forceState(e){e=e||this.defaultState;for(let t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(let t=0;t<this.checks.length;t++)this.checks[t](this,e);this.stateId=e.data}setBlend(t){this._updateCheck(e._checkBlendMode,t),this.gl[t?"enable":"disable"](this.gl.BLEND)}setOffset(t){this._updateCheck(e._checkPolygonOffset,t),this.gl[t?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)}setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)}setDepthMask(e){this.gl.depthMask(e)}setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)}setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])}setBlendMode(e){if(this.blendModesMap[e]||(e="normal"),e===this.blendMode)return;this.blendMode=e;const t=this.blendModesMap[e],r=this.gl;2===t.length?r.blendFunc(t[0],t[1]):r.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,r.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,r.blendEquationSeparate(r.FUNC_ADD,r.FUNC_ADD))}setPolygonOffset(e,t){this.gl.polygonOffset(e,t)}reset(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(this.defaultState),this._blendEq=!0,this.blendMode="",this.setBlendMode("normal")}_updateCheck(e,t){const r=this.checks.indexOf(e);t&&-1===r?this.checks.push(e):t||-1===r||this.checks.splice(r,1)}static _checkBlendMode(e,t){e.setBlendMode(t.blendMode)}static _checkPolygonOffset(e,t){e.setPolygonOffset(1,t.polygonOffset)}destroy(){this.gl=null,this.checks.length=0}};f.extension={type:[n["a"].WebGLSystem],name:"state"};let d=f},e6ba:function(e,t,r){"use strict";r.d(t,"a",(function(){return a}));var n=r("1f03"),s=r("cba2");function a(e,t){const r={},a=t.getProgramParameter(e,t.ACTIVE_UNIFORMS);for(let i=0;i<a;i++){const a=t.getActiveUniform(e,i),o=a.name.replace(/\[.*?\]$/,""),c=!!a.name.match(/\[.*?\]$/),u=Object(s["b"])(t,a.type);r[o]={name:o,index:i,type:u,size:a.size,isArray:c,value:Object(n["a"])(u,a.size)}}return r}},eb0b:function(e,t,r){"use strict";r.d(t,"a",(function(){return s}));var n=r("536a");function s(e,t){let r={},s=e.RGBA;return e instanceof n["a"].get().getWebGLRenderingContext()?t.srgb&&(r={"rgba8unorm-srgb":t.srgb.SRGB8_ALPHA8_EXT,"bgra8unorm-srgb":t.srgb.SRGB8_ALPHA8_EXT}):(r={"rgba8unorm-srgb":e.SRGB8_ALPHA8,"bgra8unorm-srgb":e.SRGB8_ALPHA8},s=e.RGBA8),{r8unorm:e.R8,r8snorm:e.R8_SNORM,r8uint:e.R8UI,r8sint:e.R8I,r16uint:e.R16UI,r16sint:e.R16I,r16float:e.R16F,rg8unorm:e.RG8,rg8snorm:e.RG8_SNORM,rg8uint:e.RG8UI,rg8sint:e.RG8I,r32uint:e.R32UI,r32sint:e.R32I,r32float:e.R32F,rg16uint:e.RG16UI,rg16sint:e.RG16I,rg16float:e.RG16F,rgba8unorm:e.RGBA,...r,rgba8snorm:e.RGBA8_SNORM,rgba8uint:e.RGBA8UI,rgba8sint:e.RGBA8I,bgra8unorm:s,rgb9e5ufloat:e.RGB9_E5,rgb10a2unorm:e.RGB10_A2,rg11b10ufloat:e.R11F_G11F_B10F,rg32uint:e.RG32UI,rg32sint:e.RG32I,rg32float:e.RG32F,rgba16uint:e.RGBA16UI,rgba16sint:e.RGBA16I,rgba16float:e.RGBA16F,rgba32uint:e.RGBA32UI,rgba32sint:e.RGBA32I,rgba32float:e.RGBA32F,stencil8:e.STENCIL_INDEX8,depth16unorm:e.DEPTH_COMPONENT16,depth24plus:e.DEPTH_COMPONENT24,"depth24plus-stencil8":e.DEPTH24_STENCIL8,depth32float:e.DEPTH_COMPONENT32F,"depth32float-stencil8":e.DEPTH32F_STENCIL8,...t.s3tc?{"bc1-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT1_EXT,"bc2-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT3_EXT,"bc3-rgba-unorm":t.s3tc.COMPRESSED_RGBA_S3TC_DXT5_EXT}:{},...t.s3tc_sRGB?{"bc1-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT1_EXT,"bc2-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT3_EXT,"bc3-rgba-unorm-srgb":t.s3tc_sRGB.COMPRESSED_SRGB_ALPHA_S3TC_DXT5_EXT}:{},...t.rgtc?{"bc4-r-unorm":t.rgtc.COMPRESSED_RED_RGTC1_EXT,"bc4-r-snorm":t.rgtc.COMPRESSED_SIGNED_RED_RGTC1_EXT,"bc5-rg-unorm":t.rgtc.COMPRESSED_RED_GREEN_RGTC2_EXT,"bc5-rg-snorm":t.rgtc.COMPRESSED_SIGNED_RED_GREEN_RGTC2_EXT}:{},...t.bptc?{"bc6h-rgb-float":t.bptc.COMPRESSED_RGB_BPTC_SIGNED_FLOAT_EXT,"bc6h-rgb-ufloat":t.bptc.COMPRESSED_RGB_BPTC_UNSIGNED_FLOAT_EXT,"bc7-rgba-unorm":t.bptc.COMPRESSED_RGBA_BPTC_UNORM_EXT,"bc7-rgba-unorm-srgb":t.bptc.COMPRESSED_SRGB_ALPHA_BPTC_UNORM_EXT}:{},...t.etc?{"etc2-rgb8unorm":t.etc.COMPRESSED_RGB8_ETC2,"etc2-rgb8unorm-srgb":t.etc.COMPRESSED_SRGB8_ETC2,"etc2-rgb8a1unorm":t.etc.COMPRESSED_RGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgb8a1unorm-srgb":t.etc.COMPRESSED_SRGB8_PUNCHTHROUGH_ALPHA1_ETC2,"etc2-rgba8unorm":t.etc.COMPRESSED_RGBA8_ETC2_EAC,"etc2-rgba8unorm-srgb":t.etc.COMPRESSED_SRGB8_ALPHA8_ETC2_EAC,"eac-r11unorm":t.etc.COMPRESSED_R11_EAC,"eac-rg11unorm":t.etc.COMPRESSED_SIGNED_RG11_EAC}:{},...t.astc?{"astc-4x4-unorm":t.astc.COMPRESSED_RGBA_ASTC_4x4_KHR,"astc-4x4-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_4x4_KHR,"astc-5x4-unorm":t.astc.COMPRESSED_RGBA_ASTC_5x4_KHR,"astc-5x4-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x4_KHR,"astc-5x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_5x5_KHR,"astc-5x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_5x5_KHR,"astc-6x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_6x5_KHR,"astc-6x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x5_KHR,"astc-6x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_6x6_KHR,"astc-6x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_6x6_KHR,"astc-8x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x5_KHR,"astc-8x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x5_KHR,"astc-8x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x6_KHR,"astc-8x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x6_KHR,"astc-8x8-unorm":t.astc.COMPRESSED_RGBA_ASTC_8x8_KHR,"astc-8x8-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_8x8_KHR,"astc-10x5-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x5_KHR,"astc-10x5-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x5_KHR,"astc-10x6-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x6_KHR,"astc-10x6-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x6_KHR,"astc-10x8-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x8_KHR,"astc-10x8-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x8_KHR,"astc-10x10-unorm":t.astc.COMPRESSED_RGBA_ASTC_10x10_KHR,"astc-10x10-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_10x10_KHR,"astc-12x10-unorm":t.astc.COMPRESSED_RGBA_ASTC_12x10_KHR,"astc-12x10-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x10_KHR,"astc-12x12-unorm":t.astc.COMPRESSED_RGBA_ASTC_12x12_KHR,"astc-12x12-unorm-srgb":t.astc.COMPRESSED_SRGB8_ALPHA8_ASTC_12x12_KHR}:{}}}},f172:function(e,t,r){"use strict";r.d(t,"a",(function(){return i}));r("907a"),r("986a"),r("1d02"),r("3c5d"),r("1b3b"),r("3d71"),r("c6e3");var n=r("c1ba"),s=r("3456");const a=new Int32Array(n["a"]);for(let o=0;o<n["a"];o++)a[o]=o;const i=new s["a"]({uTextures:{value:a,type:"i32",size:n["a"]}},{isStatic:!0})},f50e:function(e,t,r){"use strict";r.d(t,"a",(function(){return n})),r.d(t,"b",(function(){return s})),r.d(t,"c",(function(){return a}));var n=(e=>(e[e["RGBA"]=6408]="RGBA",e[e["RGB"]=6407]="RGB",e[e["RG"]=33319]="RG",e[e["RED"]=6403]="RED",e[e["RGBA_INTEGER"]=36249]="RGBA_INTEGER",e[e["RGB_INTEGER"]=36248]="RGB_INTEGER",e[e["RG_INTEGER"]=33320]="RG_INTEGER",e[e["RED_INTEGER"]=36244]="RED_INTEGER",e[e["ALPHA"]=6406]="ALPHA",e[e["LUMINANCE"]=6409]="LUMINANCE",e[e["LUMINANCE_ALPHA"]=6410]="LUMINANCE_ALPHA",e[e["DEPTH_COMPONENT"]=6402]="DEPTH_COMPONENT",e[e["DEPTH_STENCIL"]=34041]="DEPTH_STENCIL",e))(n||{}),s=(e=>(e[e["TEXTURE_2D"]=3553]="TEXTURE_2D",e[e["TEXTURE_CUBE_MAP"]=34067]="TEXTURE_CUBE_MAP",e[e["TEXTURE_2D_ARRAY"]=35866]="TEXTURE_2D_ARRAY",e[e["TEXTURE_CUBE_MAP_POSITIVE_X"]=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",e[e["TEXTURE_CUBE_MAP_NEGATIVE_X"]=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",e[e["TEXTURE_CUBE_MAP_POSITIVE_Y"]=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",e[e["TEXTURE_CUBE_MAP_NEGATIVE_Y"]=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",e[e["TEXTURE_CUBE_MAP_POSITIVE_Z"]=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",e[e["TEXTURE_CUBE_MAP_NEGATIVE_Z"]=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",e))(s||{}),a=(e=>(e[e["UNSIGNED_BYTE"]=5121]="UNSIGNED_BYTE",e[e["UNSIGNED_SHORT"]=5123]="UNSIGNED_SHORT",e[e["UNSIGNED_SHORT_5_6_5"]=33635]="UNSIGNED_SHORT_5_6_5",e[e["UNSIGNED_SHORT_4_4_4_4"]=32819]="UNSIGNED_SHORT_4_4_4_4",e[e["UNSIGNED_SHORT_5_5_5_1"]=32820]="UNSIGNED_SHORT_5_5_5_1",e[e["UNSIGNED_INT"]=5125]="UNSIGNED_INT",e[e["UNSIGNED_INT_10F_11F_11F_REV"]=35899]="UNSIGNED_INT_10F_11F_11F_REV",e[e["UNSIGNED_INT_2_10_10_10_REV"]=33640]="UNSIGNED_INT_2_10_10_10_REV",e[e["UNSIGNED_INT_24_8"]=34042]="UNSIGNED_INT_24_8",e[e["UNSIGNED_INT_5_9_9_9_REV"]=35902]="UNSIGNED_INT_5_9_9_9_REV",e[e["BYTE"]=5120]="BYTE",e[e["SHORT"]=5122]="SHORT",e[e["INT"]=5124]="INT",e[e["FLOAT"]=5126]="FLOAT",e[e["FLOAT_32_UNSIGNED_INT_24_8_REV"]=36269]="FLOAT_32_UNSIGNED_INT_24_8_REV",e[e["HALF_FLOAT"]=36193]="HALF_FLOAT",e))(a||{})},fb0c:function(e,t,r){"use strict";r.d(t,"a",(function(){return o}));r("d9e2");var n=r("536a"),s=r("fa73"),a=r("2a40");const i=class e{constructor(e){this.supports={uint32Indices:!0,uniformBufferObject:!0,vertexArrayObject:!0,srgbTextures:!0,nonPowOf2wrapping:!0,msaa:!0,nonPowOf2mipmaps:!0},this._renderer=e,this.extensions=Object.create(null),this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this)}get isLost(){return!this.gl||this.gl.isContextLost()}contextChange(e){this.gl=e,this._renderer.gl=e}init(t){if(t={...e.defaultOptions,...t},t.context)this.initFromContext(t.context);else{var r,n;const e=this._renderer.background.alpha<1,s=null===(r=t.premultipliedAlpha)||void 0===r||r,a=t.antialias&&!this._renderer.backBuffer.useBackBuffer;this.createContext(t.preferWebGLVersion,{alpha:e,premultipliedAlpha:s,antialias:a,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:null!==(n=t.powerPreference)&&void 0!==n?n:"default"})}}initFromContext(e){this.gl=e,this.webGLVersion=e instanceof n["a"].get().getWebGLRenderingContext()?1:2,this.getExtensions(),this.validateContext(e),this._renderer.runners.contextChange.emit(e);const t=this._renderer.view.canvas;t.addEventListener("webglcontextlost",this.handleContextLost,!1),t.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}createContext(e,t){let r;const n=this._renderer.view.canvas;if(2===e&&(r=n.getContext("webgl2",t)),!r&&(r=n.getContext("webgl",t),!r))throw new Error("This browser does not support WebGL. Try using the canvas renderer");this.gl=r,this.initFromContext(this.gl)}getExtensions(){const{gl:e}=this,t={anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),s3tc:e.getExtension("WEBGL_compressed_texture_s3tc"),s3tc_sRGB:e.getExtension("WEBGL_compressed_texture_s3tc_srgb"),etc:e.getExtension("WEBGL_compressed_texture_etc"),etc1:e.getExtension("WEBGL_compressed_texture_etc1"),pvrtc:e.getExtension("WEBGL_compressed_texture_pvrtc")||e.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc"),atc:e.getExtension("WEBGL_compressed_texture_atc"),astc:e.getExtension("WEBGL_compressed_texture_astc"),bptc:e.getExtension("EXT_texture_compression_bptc"),rgtc:e.getExtension("EXT_texture_compression_rgtc"),loseContext:e.getExtension("WEBGL_lose_context")};if(1===this.webGLVersion)this.extensions={...t,drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBGL_depth_texture"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear"),vertexAttribDivisorANGLE:e.getExtension("ANGLE_instanced_arrays"),srgb:e.getExtension("EXT_sRGB")};else{this.extensions={...t,colorBufferFloat:e.getExtension("EXT_color_buffer_float")};const r=e.getExtension("WEBGL_provoking_vertex");r&&r.provokingVertexWEBGL(r.FIRST_VERTEX_CONVENTION_WEBGL)}}handleContextLost(e){e.preventDefault(),this._contextLossForced&&(this._contextLossForced=!1,setTimeout(()=>{var e;this.gl.isContextLost()&&(null===(e=this.extensions.loseContext)||void 0===e||e.restoreContext())},0))}handleContextRestored(){this._renderer.runners.contextChange.emit(this.gl)}destroy(){var e;const t=this._renderer.view.canvas;this._renderer=null,t.removeEventListener("webglcontextlost",this.handleContextLost),t.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),null===(e=this.extensions.loseContext)||void 0===e||e.loseContext()}forceContextLoss(){var e;null===(e=this.extensions.loseContext)||void 0===e||e.loseContext(),this._contextLossForced=!0}validateContext(e){const t=e.getContextAttributes();t&&!t.stencil&&Object(a["a"])("Provided WebGL context does not have a stencil buffer, masks may not render correctly");const r=this.supports,n=2===this.webGLVersion,s=this.extensions;r.uint32Indices=n||!!s.uint32ElementIndex,r.uniformBufferObject=n,r.vertexArrayObject=n||!!s.vertexArrayObject,r.srgbTextures=n||!!s.srgb,r.nonPowOf2wrapping=n,r.nonPowOf2mipmaps=n,r.msaa=n,r.uint32Indices||Object(a["a"])("Provided WebGL context does not support 32 index buffer, large scenes may not render correctly")}};i.extension={type:[s["a"].WebGLSystem],name:"context"},i.defaultOptions={context:null,premultipliedAlpha:!0,preserveDrawingBuffer:!1,powerPreference:void 0,preferWebGLVersion:2};let o=i}}]);
//# sourceMappingURL=chunk-4f14e4ea.eb45cb5a.js.map